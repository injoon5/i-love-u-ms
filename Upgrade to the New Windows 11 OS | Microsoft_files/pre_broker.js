if(void 0===COMSCORE)var COMSCORE={};void 0===COMSCORE.PreBroker&&(COMSCORE.PreBroker={eligible:!0,sv:"scor",cookies:{flag:"cleflag",test:"tstMode",ms:"msresearch",domain:".microsoft.com",duration:90},mobile:{m:"iphone|ipad|ipod|android|opera mini|blackberry|windows (phone|ce)|iemobile|htc|nokia|bb10|silk|reddit",u:"phone|sm-(n|g)|pixel.+xl|ph-1|oneplus|lg-|nexus 6|lm-q"},altRules:{enabled:!1,refMatch:"google.com|microsoft.com|products.office.com|xbox.com"},mappings:[{pid:"p3093325447",m:"^http(s)?://www\\.microsoft\\.com/en-us/ai",a:"",s:"3418",d:"1",f:"0.033",altF:"0.0",cle:"https://www.microsoft.com/library/svy/int_cle.htm",p:0},{pid:"p3093325447",m:"^http(s)?://www\\.microsoft\\.com/en-us/ai",a:"",s:"3418",d:"2",f:"0.033",altF:"0.0",cle:"https://www.microsoft.com/library/svy/int_cle.htm",p:0},{pid:"p3093325447",m:"^http(s)?://www\\.microsoft\\.com/en-us/ai",a:"",s:"3418",d:"3",f:"0.033",altF:"0.0",cle:"https://www.microsoft.com/library/svy/int_cle.htm",p:0}]},COMSCORE.PreBroker.Utils=function(){var s=COMSCORE.PreBroker,n=COMSCORE.PreBroker.mappings,a=COMSCORE.PreBroker.cookies;return{getCookieVal:function(e){return match=document.cookie.match(new RegExp(e+"=([^;]+)")),null!=match&&match[1]},removeCookie:function(e){var i=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;";document.cookie=i},setCookie:function(e,i,t,o,r){var n=new Date(r+24*o*60*60*1e3).toGMTString(),a=e+"=";1<i.length&&(a+=i[1]+","),a+=i[0]+";expires="+n+";domain="+t+";path=/",a+="; SameSite=Strict",document.cookie=a},checkAACookie:function(){var e=unescape(this.getCookieVal(a.ms));return!/IDLE|DDINPROGRESS/i.test(e)},isTestModeCookie:function(){return!!/cle/i.test(this.getCookieVal(a.test))},getDeviceType:function(){var e,i=new RegExp(s.mobile.m,"i"),t=new RegExp(s.mobile.u,"i"),o=self.screen.availWidth;return i.test(navigator.userAgent)?(e=2,770<=o&&!t.test(navigator.userAgent)&&(e=3)):e=1,e},findMappings:function(e,t){var o=[];for(i=0;i<t.length;i++){var r=t[i];if(r){var n=new RegExp(r.m,"i"),a=!1;n.test(window.location)&&(r.a&&((n=new RegExp(r.a,"i")).test(window.location)||(a=!0)),r.o&&((n=new RegExp(r.o,"i")).test(navigator.userAgent)||(a=!0)),r.d&&r.d!=e&&(a=!0),r.r&&((n=new RegExp(r.r,"i")).test(document.referrer)||(a=!0)),0==a&&o.push(i))}}return 0==o.length?void(s.eligible=!1):this.chooseMapping(o)},chooseMapping:function(e){if(1==e.length)return e[0];var t=e[0],o=0;for(i=0;i<e.length;i++)n[e[i]].p&&n[e[i]].p>o&&(o=n[e[i]].p,t=e[i]);return t},rollDice:function(e){return this.getRandom()<n[e].f},getRandom:function(e){function i(e,i,t,o,r){var n=Math.floor(e/t);return n=i*(e-n*t)-n*o,Math.round(n<0?n+r:n)}for(var t=2147483563,o=40014,r=53668,n=12211,a=2147483647&Math.round((new Date).getTime()%1e5),s=a,c=[32],l=0;l<19;l++)s=i(s,o,r,n,t);for(l=0;l<32;l++)s=i(s,o,r,n,t),c[31-l]=s;s=i(s,o,r,n,t),a=i(a,40692,52774,3791,2147483399);var f=Math.round((c[Math.floor(c[0]/67108862)]+a)%t),p=Math.floor(f/(t/(1e9+1)))/1e9;return void 0===e?p:Math.floor(p*(e+1))},start:function(){if(0!=this.checkAACookie()){var e=this.findMappings(this.getDeviceType(),n);if(0<=e?this.logExposure(e):s.eligible=!1,/int\_cle\.htm/i.test(document.referrer)&&(s.eligible=!1),n[e]&&1==n[e].h)s.eligible=!1;else if(0!=s.eligible)1==s.altRules.enabled&&new RegExp(s.altRules.refMatch,"i").test(document.referrer.toString())&&(n[e].f=n[e].altF),this.isTestModeCookie()&&(n[e].f=100),this.rollDice(e)&&this.loadCLE(e)}},logExposure:function(e){var i=n[e],t=this.getCookieVal(a.flag),o=(new Date).getTime(),r=new Array;if(r[0]=i.pid+":1-"+o,0!=t){if(new RegExp(i.pid,"i").test(t))return void(s.eligible=!1);r[1]=t}this.setCookie(a.flag,r,a.domain,a.duration,o)},loadCLE:function(e){var i=n[e],t=i.cle+"?location="+escape(window.location)+"&referrer="+escape(document.referrer)+"&frequency="+i.f+"&weight=100&site="+i.s+"&device="+s.Utils.getDeviceType()+"&pid="+i.pid;i.delay||(i.delay=0),setTimeout(function(){window.location.href=t},i.delay)}}}()),COMSCORE.PreBroker.Utils.start();